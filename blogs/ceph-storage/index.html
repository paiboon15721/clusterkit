<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta http-equiv=x-ua-compatible content="ie=edge"><title>ClusterKit - Ceph Storage</title><link rel="shortcut icon" type=image/png href=/clusterkit/favicon.ico><link rel=stylesheet href=/clusterkit/scss/main.min.b0087a6de86733cd1820449f67d147f53c71431bb7d5d8656aafe6570e625bcc.css></head><body><nav class="navbar navbar-expand-lg navbar-light fixed-top"><div class=container><a class=navbar-brand href=/clusterkit/><img src=/clusterkit/logo.png height=45 class="d-inline-block align-top" alt="ClusterKit logo"></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarsExampleDefault aria-controls=navbarsExampleDefault aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarsExampleDefault><ul class="navbar-nav mr-auto"><li class=nav-item><a class=nav-link href=/clusterkit/>หน้าหลัก</a></li><li class=nav-item><a class=nav-link href=/clusterkit/service/>บริการของเรา</a></li><li class=nav-item><a class=nav-link href=/clusterkit/training-courses/>เทรนนิ่ง</a></li><li class=nav-item><a class=nav-link href=/clusterkit/success-stories/>ผลงานของเรา</a></li><li class=nav-item><a class=nav-link href=/clusterkit/blogs/>บล็อก</a></li><li class=nav-item><a class=nav-link href=/clusterkit/about-us/>เกี่ยวกับเรา</a></li><li class=nav-item><a class=nav-link href=/clusterkit/contact-us/>ติดต่อเรา</a></li></ul><a href=callto:028813800><span class=navbar-text><i class="fas fa-phone mr-2"></i>0 2881 3800</span></a></div></div></nav><main role=main><div class="container mt-5"><div class=row><div class="col-md-8 offset-md-2"><h1 class=display-5>Ceph Storage</h1><div class=h1-line></div><div class=markdown><p>Software-Defined Storage เป็นคำนิยามหนึ่งของฝั่ง Storage ที่เริ่มเป็นที่นิยมหลักการคือการนำเครื่อง คอมพิวเตอร์หรือเซอร์เวอร์หลาย ๆ เครื่อง มาติดตั้งซอฟต์แวร์เพื่อให้บริการเป็นระบบจัดเก็บข้อมูล แทนที่จะต้องซื้อระบบ Storage แบบเดิม ๆ ที่มีราคาแพงกว่า เมื่อมีปัญหาก็ต้องเรียก Vender มาแก้ไข ไม่สามารถดูและระบบเองได้ จะขยายระบบเพิ่มก็ต้องซื้อของจาก Vender เดียวกัน</p><p>ซึ่งในตลาดก็มีซอฟต์แวร์หลาย ๆ ตัว ที่เป็น SDS ทั้งที่เป็น Open Source และ Propietory Software สามารถให้บริการเป็น NAS หรือ SAN แทนระบบ Storage แบบเดิมได้ ซึ่งบทความนี้จะแนะนำซอฟต์แวร์ที่ชื่อ Ceph ตัว Ceph มีความแตกต่างจากซอฟต์แวร์ตัวอื่น โดย Ceph เป็น Open Source Software ที่สามารถให้บริการเป็น NAS, SAN หรือ Object Storage ซึ่งเป็นจุดเด่นที่ยังไม่เจอในซอฟต์แวร์ตัวอื่น ๆ</p><div class="d-flex my-4"><figure class="figure mx-auto"><img src=/clusterkit/imgs/blogs/ceph-2.png class="figure-img img-fluid rounded" alt="A generic square placeholder image with rounded corners in a figure."><figcaption class="figure-caption text-center">Software Comparison</figcaption></figure></div><h2 id=ความเป-นมาของ-ceph>ความเป็นมาของ Ceph</h2><div class="d-flex my-4"><figure class="figure mx-auto"><img src=/clusterkit/imgs/blogs/ceph-1.png class="figure-img img-fluid rounded" alt="A generic square placeholder image with rounded corners in a figure."><figcaption class="figure-caption text-center">Ceph Logo</figcaption></figure></div><p>Ceph เป็นซอฟต์แวร์ทำ Software-Defined Storage ที่เป็น Open Source ได้รับความนิยมติดตั้งเป็น Backend การเก็บข้อมูลในระบบ OpenStack และมีขนาดของ community ที่ใหญ่ขึ้นเรื่อย ๆ</p><p>ชื่อของ Ceph นั้นมาจากคำว่า &ldquo;cephalopod&rdquo; ซึ่งเป็นสัตว์ในตระกูลปลาหมึก (Octopus and squid) Ceph นั้นเริ่มต้นโดย Sage Weil ในปี 2003 โดยเป็นส่วนหนึ่งของวิทยานิพนธ์ (PhD project) ณ University of California, Santa Cruz โดยสำเร็จในปี 2007.
ในปี 2012 Sage Weil ได้ก่อตั้งบริษัท Inktank ขึ้นมาเพื่อทำธุรกิจให้บริการ support ซอฟต์แวร์ Ceph ในระดับ Enterprise โดยเป็นทั้งผู้ก่อตั้ง และ CTO ของบริษัทฯ และถูก Red Hat ซื้อไปในปี 2014 ด้วยราคา $175 Million</p><p>ปัจจุบัน Sage Weil ทำงานที่ Red Hat ในฐานะ Ceph Principal Architect และเป็น Chief Architect ของโครงการ Ceph Updaate : ปัจจุบัน Red Hat ได้ถูกซื้อกิจการไปอยู่กับ IBM ด้วยราคา $34 Billion</p><h2 id=ceph-architecture>Ceph Architecture</h2><div class="d-flex my-4"><figure class="figure mx-auto"><img src=/clusterkit/imgs/blogs/ceph-3.png class="figure-img img-fluid rounded" alt="A generic square placeholder image with rounded corners in a figure."><figcaption class="figure-caption text-center">Ceph Architecture</figcaption></figure></div><p>Ceph จะประกอบด้วยส่วนประกอบหลัก ๆ 3 ส่วน คือ</p><ol><li>MON (Monitor Node)ทำหน้าที่ดูแลสถานะของ Ceph cluster</li><li>OSD (Object Storage Node) เป็น Node ทำหน้าที่เก็บข้อมูล ของระบบ หากต้องการใช้ CephFS จะต้องมี</li><li>MDS (Metadata Node) ทำหน้าที่ดูแลสถานะของ file hierarchy (สำหรับ CephFS เท่านั้น)</li></ol><p>MON และ MDS สามารถทำ High Availablity ได้ โดยการติดตั้ง MON ขั้นต่ำ 3 ตัว ส่วน MDS ติดตั้งเป็นแบบ Active/Stand by</p><p>ในคลัสเตอร์ Ceph การติดต่อกันระหว่าง MON, MDS และ OSD นั้นจะติดต่อผ่าน Public Network ในวง Cluster Network จะใช้ในการ Replication ข้อมูลระหว่าง OSD เท่านั้น หากดีไซน์แบบประหยัดก็สามารถตัด Cluster Network ออกไปได้ ระบบยังสามารถทำงานได้ แต่จะกระทบจังหวะที่มีการ Replication ข้อมูลระหว่าง OSDs หนัก ๆ จะทำให้ระบบช้าลงได้</p><h2 id=version>Version</h2><p>เวอร์ชั่นล่าสุด ณ ปัจจุบัน (มกราคม 2019) จะเป็นเวอร์ชั่น Mimic (v13.2.0) — on June 1, 2018 โดยทาง Ceph มีแผนที่จะปล่อยเวอร์ชั่นใหม่ ทุก ๆ 9 เดือน โดยประมาณ Version number จะแยกได้คือ</p><ul><li>x.0.z — development (for early testers)</li><li>x.1.z — release candidates (for test clusters)</li><li>x.2.z — stable/bugfix (for users/production)</li></ul><p>โดยการเลือกใช้งาน Ceph นั้น แนะนำให้เลือกเป็น Stable Version คือ Version.2.x</p><h2 id=การใช-งานระบบ>การใช้งานระบบ</h2><p>การให้บริการ สำหรับ Client ที่เข้ามาใช้งานในระบบโดยตรง จะต้องมี Kernel ที่สนับสนุน Ceph มีเบอร์ IP วงเดียวกับ Ceph สามารถติดต่อตรงกับเครื่องในระบบ Ceph ได้ ถ้าต้องการให้บริการ Windows หรือ Clients อื่น ๆ ที่ไม่ได้เป็น Linux จะต้องทำ Gateway เช่น rados gateway และให้เครื่องติดต่อมาที่ gateway หากเป็น CephFS ก็ mount CephFs และแชร์ผ่าน SAMBA ออกไปให้เครื่อง Windows สามารถใช้งานพื้นที่ Ceph ได้</p><h2 id=ข-อด-ข-อเส-ย-ของ-ceph>ข้อดี-ข้อเสีย ของ Ceph</h2><ul><li>เป็น Open source ไม่มีค่าใช้จ่ายสำหรับตัวซอฟต์แวร์ แต่หากต้องการ Support ก็จะมี subscirption ของ Vender หลาย ๆ ค่าย เช่น RedHat, SuSe ขายอยู่เช่นกัน</li><li>สามารถให้บริการได้หลากหลายรูปแบบ (Block, Object, Filesystem)</li><li>สามารถขยายระบบได้ง่าย เพียงเติมเครื่องเข้าระบบ</li><li>ใช้ Hardware ทั่ว ๆ ไป ไม่จำเป็นต้องเป็น Hardware เฉพาะแต่ละส่วนมีความคงทนของระบ (High Availability) ไม่ว่าจะเป็น MON, MDS หรือ OSD</li></ul><p>ข้อเสียที่ชัดที่สุดของ Ceph นั้นจะเปลืองดิสก์กว่า Storage แบบปกติ เนื่องจากเทคโนโลยีในการเก็บ ข้อมูลของ Ceph ที่จะเก็บสำเนาของข้อมูลไว้ 2–3 ชุด สำหรับ High Availablity เพื่อให้มั่นใจว่าถ้า บางเครื่องในระบบมีปัญหาจะยังคงสามารถอ่านเขียนข้อมูลจาก Ceph ได้ โดยไม่ต้องปิดระบบ แต่ในเวอร์ชั่นใหม่ ๆ ก็มีการพัฒนาการจัดเก็บแบบ Erasure Coding สำหรับการเก็บแบบ Archive ที่ไม่ได้อ่านเขียนบ่อย โดยจะเปลี่ยนการเก็บข้อมูลคล้าย ๆ RAID ซึ่งจะเก็บข้อมูลได้มากกว่า</p><div class="d-flex my-4"><figure class="figure mx-auto"><img src=/clusterkit/imgs/blogs/ceph-4.png class="figure-img img-fluid rounded" alt="A generic square placeholder image with rounded corners in a figure."><figcaption class="figure-caption text-center">Ceph Erasure Coding</figcaption></figure></div><h2 id=real-case-ceph-cluster-store-data-for-windows-client>Real Case — Ceph Cluster Store Data for Windows Client</h2><p>เป็นระบบ Ceph Cluster ขนาดประมาณ 500TB จำนวณ 45 เครื่อง ให้บริการ File System แก่ Client ที่เป็น Windows และมีการ Authenticate ผ่าน Active Directory Server</p><div class="d-flex my-4"><figure class="figure mx-auto"><img src=/clusterkit/imgs/blogs/ceph-5.png class="figure-img img-fluid rounded" alt="A generic square placeholder image with rounded corners in a figure."><figcaption class="figure-caption text-center">Ceph Cluster Store Data for Windows Client</figcaption></figure></div><h2 id=ผลงานท-ผ-านมา>ผลงานที่ผ่านมา</h2><ul><li><a href=https://www.gistda.or.th target=_blank>สำนักงานพัฒนาเทคโนโลยีอวกาศและภูมิสารสนเทศ (องค์การมหาชน)</a></li><li><a href=https://www.sisthai.com target=_blank>SiS Distribution (Thailand) PCL.</a></li></ul></div></div></div></div></main><footer class="container pt-2 mb-md-4 mt-5 pt-md-3"><div class=row><div class="col-12 col-sm-6 col-md"><h5>บริษัท คลัสเตอร์คิท จำกัด</h5><ul class="list-unstyled text-small"><li class=text-muted>เลขที่ 91 ซ.ริมคลองชักพระ<br>ถนนบางขุนนนท์ แขวงบางขุนนนท์<br>เขตบางกอกน้อย กทม. 10700<br>เลขทะเบียนนิติบุคคล: 0105550004011</li><li class="text-muted my-2"><a href=callto:028813800><span><i class="fas fa-phone mr-2"></i>0 2881 3800</span></a></li><li class="text-muted my-2"><a href=mailto:info@clusterkit.co.th><span><i class="fas fa-envelope mr-2"></i>info@clusterkit.co.th</span></a></li><li class="text-muted my-2"><a href=https://www.facebook.com/clusterkit target=_blank><span><i class="fab fa-facebook-square mr-2"></i>ClusterKit</span></a></li></ul></div><div class="col-12 col-sm-6 col-md"><h5>ClusterKit</h5><ul class="list-unstyled text-small"><li><a class=text-muted href=/clusterkit/>หน้าหลัก</a></li><li><a class=text-muted href=/clusterkit/service/>บริการของเรา</a></li><li><a class=text-muted href=/clusterkit/training-courses/>เทรนนิ่ง</a></li><li><a class=text-muted href=/clusterkit/success-stories/>ผลงานของเรา</a></li><li><a class=text-muted href=/clusterkit/blogs/>บล็อก</a></li><li><a class=text-muted href=/clusterkit/about-us/>เกี่ยวกับเรา</a></li><li><a class=text-muted href=/clusterkit/contact-us/>ติดต่อเรา</a></li></ul></div><div class="col-12 col-sm-6 col-md"><h5>ClusterKit Tutorial</h5><ul class="list-unstyled text-small"><li><a class=text-muted href=http://www.clusterkit.co.th/pdf/ZorinOS.pdf target=_blank>Zonrin OS Education</a></li><li><a class=text-muted href=http://www.clusterkit.co.th/pdf/SparkLocal&Zeppelin.pdf target=_blank>Apache Spark and Zeppelin</a></li><li><a class=text-muted href=http://www.clusterkit.co.th/pdf/WRF3.8.1_InstallationGuide.pdf target=_blank>WRF on Rocks Cluster</a></li><li><a class=text-muted href=http://www.clusterkit.co.th/pdf/MariaDBGaleraCluster_Tutorial.pdf target=_blank>MariaDB Galera Cluster</a></li><li><a class=text-muted href=http://www.clusterkit.co.th/pdf/OpenStack_Tutorial.pdf target=_blank>OpenStack</a></li><li><a class=text-muted href=http://www.clusterkit.co.th/pdf/EC2_Tutorial.pdf target=_blank>Amazon EC2</a></li></ul></div><div class="col-12 col-sm-6 col-md"><h5>บริการสารสนเทศ</h5><ul class="list-unstyled text-small"><li><a class=text-muted href=http://www.clusterkit.co.th/pdf/CloudComputingWithOpenSourceOssfest11.pdf target=_blank>Cloud Computing With Open Source</a></li><li><a class=text-muted href=http://www.clusterkit.co.th/pdf/MySQL_Cluster_Ossfest11.pdf target=_blank>MySQL Cluster</a></li><li><a class=text-muted href=http://www.clusterkit.co.th/pdf/HPC-Intro-EGAT.pdf target=_blank>Cluster HPC on Open Source</a></li></ul></div><div class="col-12 border-top mt-3"><small class="d-block text-muted my-4">Copyright &copy; 2007-2019 ClusterKit All rights
reserved.</small></div></div></footer><script src=https://code.jquery.com/jquery-3.3.1.slim.min.js integrity=sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js integrity=sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1 crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js integrity=sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM crossorigin=anonymous></script><script>var $nav=$('.navbar')
var $navCollapse=$('.navbar-collapse')
$(document).scroll(function(){$nav.toggleClass('bg-light',$(this).scrollTop()>$nav.height())})
$('main, footer').on('click',function(){$navCollapse.collapse('hide')})</script></body></html>